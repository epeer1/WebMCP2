// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`generateMCPCodeSync > matches snapshot for complete generated code (ContactForm) 1`] = `
"// Auto-generated by WebMCP Auto-Instrumentor
// Do not edit manually — re-run \`webmcp instrument\` to regenerate
// Source hash: send_contact_form
// Template mode (sync)
// Requires: @webmcp/runtime — https://github.com/epeer1/WebMCP2

// ── WebMCP DOM helpers ──────────────────────────────────────
function __mcpSetValue(selector, value) {
  const el = document.querySelector(selector);
  if (!el) throw new Error('[WebMCP] Element not found: ' + selector);
  // Use native setter to bypass React's value tracking
  const proto = el instanceof HTMLTextAreaElement
    ? HTMLTextAreaElement.prototype
    : HTMLInputElement.prototype;
  const nativeSetter = Object.getOwnPropertyDescriptor(proto, 'value')?.set;
  if (nativeSetter) {
    nativeSetter.call(el, value);
  } else {
    el.value = value;
  }
  el.dispatchEvent(new Event('input', { bubbles: true }));
  el.dispatchEvent(new Event('change', { bubbles: true }));
}

function __mcpSetChecked(selector, checked) {
  const el = document.querySelector(selector);
  if (!el) throw new Error('[WebMCP] Element not found: ' + selector);
  const nativeSetter = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, 'checked')?.set;
  if (nativeSetter) nativeSetter.call(el, checked);
  else el.checked = checked;
  el.dispatchEvent(new Event('change', { bubbles: true }));
}

function __mcpSetSelect(selector, value) {
  const el = document.querySelector(selector);
  if (!el) throw new Error('[WebMCP] Element not found: ' + selector);
  el.value = value;
  el.dispatchEvent(new Event('change', { bubbles: true }));
}

function __mcpClick(selector) {
  const el = document.querySelector(selector);
  if (!el) throw new Error('[WebMCP] Element not found: ' + selector);
  el.click();
}
// ────────────────────────────────────────────────────────────


const tool_send_contact_form = {
  name: "send_contact_form",
  description: "Send the form with: name, email, message",
  inputSchema: {
    type: "object",
    properties: {
        "name": {
            "type": "string",
            "description": "input field"
        },
        "email": {
            "type": "string",
            "description": "email field"
        },
        "message": {
            "type": "string",
            "description": "textarea field"
        }
    },
    required: ["name","email"]
  },
  handler: async (params) => {
    try {
      __mcpSetValue('#name', params.name);
      __mcpSetValue('#email', params.email);
      __mcpSetValue('#message', params.message);
      await new Promise(r => setTimeout(r, 100));
      __mcpClick('input[type="submit"]');
      return { success: true, message: "handleSubmit triggered (POST /api/contact)" };
    } catch (err) {
      return { success: false, message: err instanceof Error ? err.message : String(err) };
    }
  }
};

if (typeof navigator !== 'undefined' && 'modelContext' in navigator) {
  navigator.modelContext.registerTool(tool_send_contact_form);
} else {
  window.mcp = window.mcp || { registerTool: () => {} };
  window.mcp.registerTool(tool_send_contact_form);
}
"
`;
